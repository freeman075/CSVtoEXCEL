첨부한 파일을 기초로 아래 지침을 참고하여 csv 파일 생성바랍니다. 

강좌명은 교시가 있고 요일이 복수인 경우 아래와 같이 강좌를 부별로 개별 등록합니다. 
- 요일별 시간이 같은 경우 : 로봇조립 1부 (화,목 13:10~14:00)
- 요일별 시간이 다른 경우 : 로봇조립 1부 (화 13:10~14:00 목 14:10~15:00)
- 원 자료에 "1부, 2부"와 같이 되어 있다면 "부"로 "1교시, 2교시"와 같이 되어 있다면 강좌명에 "교시"를 붙여 개별 생성해주세요. 
- 특히 강좌명, 강의시간 작성 규칙은 반드시 지침에 따라 작성해주세요. 

요일, 교시, 강의시간 정보가 없는 부서는 아래 "데이터 누락 보정 기능"지침에 따라 작성해주세요. 
- 요일, 교시, 강의시간 정보가 있는 직전 부서의 정보를 참조하여 작성해주세요. 
- 직전 부서에 정보가 없다면 아래에 정보가 있는 부서의 정보를 참조하여 작성해주세요. 
- 요일, 교시, 부, 시간 정보가 없어 승계한 부서도 승계한 부서의 강좌명 작성 규칙에 따르고 교시 또는 부별로 강좌가 개별 생성되어야 합니다. 
- CSV 파일의 타이틀(컬럼) 개수와 각 행의 내용 개수가 정확히 일치하도록 해주세요.
- CSV 파일 저장 시: 전체 필드를 큰따옴표(`"`)로 묶어 저장합니다.

### **기본 개요**

- **입력 형식:**
    - PDF, 이미지 파일
- **출력 형식:**
    - 강좌일괄입력 csv 파일
- **csv 출력 파일 컬럼 순서:** 반드시 이 필드 기준으로 csv 파일 생성해주세요. 없는 필드 정보는 아래 지침에 따라 작성해주세요. 
    1. 중복제한그룹
    2. 강좌명
    3. 강사ID
    4. 강사중복불가
    5. 대상학년
    6. 강의시간
    7. 강의시간중복허용
    8. 정원
    9. 대기정원
    10. 운영기간(시작)
    11. 운영기간(종료)
    12. 총시수
    13. 강의실
    14. 수강료
    15. 수용비
    16. 교재비
    17. 재료비
    18. 지원금차감제외(수강료)
    19. 지원금차감제외(교재비)
    20. 지원금차감제외(재료비)
    21. 내용

## **강좌일괄입력 csv 파일 생성 지침**

### **1. PDF 데이터 추출 및 검증**
#### **1.1 강좌 전체 목록 검토**
- 모든 강좌 정보를 PDF에서 추출합니다.
- 총 강좌 개수를 확인하여 누락 여부를 검증합니다.

#### **1.2 OCR 적용 검토**
- 이미지 형태의 텍스트가 있는 경우 OCR(문자 인식) 기술을 적용합니다.
- OCR 결과가 원본과 일치하는지 비교하여 정확성을 확인합니다.

---

### **2. 자동 변환 프로세스 개선**
#### **2.1 강좌명 및 시간 정보 강제 추출**
- 강좌명, 교시, 요일, 시간, 강사 정보를 추출하여 리스트화합니다.
- 여러 줄로 분리된 강좌명은 자동으로 한 줄로 결합합니다.

---

### **3. 최종 검증 프로세스**
#### **3.1 변환 데이터 검증**
- 변환된 강좌 개수가 PDF의 개수와 일치하는지 확인합니다.
- 누락된 항목이 있을 경우 자동 보정하여 데이터 누락을 방지합니다.

#### **3.2 강좌 목록 자동 비교 및 로그 저장**
- 강좌 목록을 텍스트 파일로 저장한 후 PDF 목록과 자동 비교합니다.
- 누락된 강좌가 발견되면 로그를 남겨 추가 검토할 수 있도록 합니다.

#### **3.3 사용자 검토 프로세스**
- 최종 변환 데이터는 엑셀 파일 형식으로 제공하여 운영자가 직접 검토할 수 있도록 합니다.
- 사용자 검토 후 수정 요청이 있을 경우 신속하게 업데이트합니다.

---

### **4. 추가 개선 사항**
#### **4.1 예외 처리 기능 강화**
- 강좌 정보가 여러 줄인 경우 자동 결합 로직을 적용합니다.
- 기본값 입력:
  - 강사명이 누락되면 "강사 없음"을 입력합니다.
  - 강의시간이 누락되면 이전 강좌의 운영시간을 기본값으로 입력합니다.

#### **4.2 PDF 변환 프로세스 개선**
- 불규칙한 표 정렬을 자동 보정하여 강좌별 정보가 올바르게 매칭되도록 합니다.
- 중복 입력을 방지하기 위한 중복 검출 기능을 추가합니다.

---

### **5. 강좌명 작성 규칙**
#### **5.1 강좌명 생성**
- **1순위**: 교시가 있으면 교시별로 개별 강좌로 생성합니다.
  - 예: `[선택형] 과학실험부 1교시 (화,목 14:00~14:45)`
- **2순위**: 교시 정보가 없다면 시간별로 개별 강좌를 생성합니다.
  - 예: `[선택형] 과학실험부 (화,목 14:00~14:45)`
- **요일 복수 처리**:
  - 요일이 복수인 경우 묶어서 하나의 강좌로 생성합니다.
  - 예: `[선택형] 생명과학 A (월,금 13:10~14:50)`

#### **5.2 시간 형식 변환**
- 시간에 `"-"`가 포함된 경우 `"~"`로 변경합니다.
  - 예: `"14:00-14:45"` → `"14:00~14:45"`

#### **5.3 프로그램 유형 표기**
- 선택형: `[선택형]`
- 맞춤형: `[맞춤형]`
- 돌봄: `[돌봄]`

---

### **6. 요일 및 교시/운영 시간 미기재 처리**
#### **6.1. 요일 및 교시 승계 규칙 추가**

- **규칙 1** : 요일 및 교시 정보가 누락된 강좌는 동일한 프로그램 유형(예: 선택형) 내에서 가장 가까운 강좌의 요일 및 교시 정보를 참조합니다.
    
    - 예: "바이올린", "방송댄스", "음악줄넘기", "한자"는 "로봇조립"의 요일 및 교시 정보를 승계합니다.
- **규칙 2** : 요일 및 교시 정보가 일부만 있는 경우(예: "월"만 있음), 동일한 프로그램 유형의 다른 강좌에서 누락된 요일을 추가합니다.
    
    - 예: "로봇조립"의 요일이 "화,목"이라면, "바이올린"도 "화,목"으로 설정합니다.

#### **6.2. 시간대 기반 승계 규칙 추가**

- **규칙 3** : 요일 및 교시 정보가 누락된 강좌는 동일한 시간대 또는 유사한 시간대를 가진 강좌의 요일 및 교시 정보를 참조합니다.
    - 예: "로봇조립 1부 (화,목 13:10~14:00)"과 동일한 시간대를 가지는 "바이올린 1부"는 동일한 요일 및 시간 정보를 승계합니다.

#### **6.3. 명시적 승계 우선순위 정의**

- **우선순위 1** : 동일한 부서명(예: 생명과학)의 직전 강좌에서 요일 및 교시 정보를 승계합니다.
- **우선순위 2** : 동일한 프로그램 유형(예: 선택형) 내에서 가장 가까운 강좌의 요일 및 교시 정보를 승계합니다.
- **우선순위 3** : 동일한 장소 또는 유사한 주제를 가진 강좌의 요일 및 교시 정보를 승계합니다.

---

### **7. 대상학년 입력 규칙**
- 기본값: `1,2,3,4,5,6`
- 범위 표기 변환:
  - `1-6학년` 또는 `1~6` → `1,2,3,4,5,6`
  - `1-2학년` 또는 `1~2학년` → `1,2`

---

### **8. 기본값 설정**
- **중복제한그룹**: `공란`
- **정원**: `25`
- **대기정원**: `5`
- **강사ID**:
  - 원칙적으로 강사명을 그대로 사용합니다.
  - 프로그램 유형이 "돌봄"인 경우 `"돌봄전담사"`를 입력합니다.
- **운영기간 기본값**:
  - 시작일: `2025-03-01`
  - 종료일: `2025-03-31`
- **강사중복불가**:
  - 기본값: `Y`
  - 돌봄 프로그램의 경우 공란으로 처리합니다.

---

### **9. 비용 관련 항목 처리**
- **수강료**:
  - `"무료"`인 경우 공란 처리합니다.
- **교재비, 재료비**:
  - 교재비, 재료비 필드에 금액 정보가 있으면, 다른 필드에 교재비, 재료비 안내가 있다면 "내용"에 출력합니다.
  - 참고사항, 비고, 내용과 관련된 정보는 "내용"에 출력합니다. 

---

### **10. 강의시간 작성 상세 규칙**
- 기본 형식: `요일:강의시간`
  - 요일은 월, 화, 수, 목, 금, 토, 일로 표기합니다.
- 구분자 사용:
  - 연속 교시: 쉼표(`,`)를 사용
    - 예: `월:5교시,6교시`
  - 주 2회 이상: 요일 사이에 공백 사용
    - 예: `화:5교시,6교시 목:5교시,6교시`

---

### **11. 기타 항목 처리**
- **미입력 항목**:
  - 데이터가 없는 경우 공란 처리합니다.
- **교시별 등록**:
  - 각 교시마다 별도의 행으로 등록합니다.

---

### **12. 주의사항**
- 자료 출처: PDF 또는 이미지 파일 내 부서 및 강좌 정보를 바탕으로 작성합니다.
- 누락 없이 변환: 모든 강좌 정보가 빠짐없이 변환되도록 주의합니다.
- 강의시간 필수 입력: 강의시간은 반드시 입력하며, 위 작성 규칙을 준수합니다.
- 미지정 정보 처리: 미지정된 정보는 바로 위 강좌의 정보를 참조하여 자동 상속합니다.
- 저장 순서: 결과 파일은 역순으로 저장합니다.
- 엑셀 서식: 표에 선을 넣고 타이틀에 배경색을 입힌 후, 컬럼 넓이를 자동 조절하여 보기 좋게 만듭니다.

---

위 지침은 생명과학과 같은 요일 승계 문제를 해결하기 위해 필요한 규칙을 포함하며, 중복을 제거하고 명확하게 정리되었습니다.